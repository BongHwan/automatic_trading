{% extends "base.html" %}
{% block content %}

{{ macros.m_button_group([['globalSettingSaveBtn', '설정 저장'], ['globalOneExecuteBtn', '1회 실행'], ['globalImmediatelyExecuteBtn', '즉시 실행']])}}

<nav>
  {{ macros.m_tab_head_start() }}
    {{ macros.m_tab_head('normal', '기본', true) }}
    {{ macros.m_tab_head('auto', '자동', false) }}
    {{ macros.m_tab_head('db', 'DB', false) }}
  {{ macros.m_tab_head_end() }}
</nav>

<form id='setting'>
  <div class="tab-content" id="nav-tabContent">
    {{ macros.m_tab_content_start('normal', true) }}
      {{ macros.setting_input_text(f'{name}_trade_amount_percent', '포지션 비율(%)', value=arg[name + '_trade_amount_percent'], col=3) }}
      {{ macros.setting_input_text(f'{name}_leverage', '레버리지', value=arg[name + '_leverage'], col=3) }}
      {{ macros.setting_input_text(f'{name}_take_profit_percent', '익절 %', value=arg[name + '_take_profit_percent'], col=3) }}
      {{ macros.setting_input_text(f'{name}_stop_loss_percent', '손절 %', value=arg[name + '_stop_loss_percent'], col=3) }}
      {{ macros.setting_input_text(f'{name}_max_holding_minutes', '최대 보유시간(분)', value=arg[name + '_max_holding_minutes'], col=3) }}
      {{ macros.setting_radio_with_value(f'{name}_mode', '모드', [['simulation', '시뮬레이션'], ['real', '실거래']], value=arg[name + '_mode']) }}
    {{ macros.m_tab_content_end() }}

    {{ macros.m_tab_content_start('auto', false) }}
      {{ macros.global_setting_scheduler_button(arg['is_include'], arg['is_running']) }}
      {{ macros.setting_input_text(f'{name}_interval', '스케줄 간격', value=arg[name + '_interval'], col=3, desc=['Cron 형식 또는 분 단위']) }}
      {{ macros.setting_checkbox(f'{name}_auto_start', '시작시 자동 실행', value=arg[name + '_auto_start']) }}
    {{ macros.m_tab_content_end() }}

    {{ macros.m_tab_content_start('db', false) }}
      {{ macros.setting_input_text_and_buttons(f'{name}_db_delete_day', 'DB 삭제 기간(일)', [['globalDbDeleteDayBtn', '기간 적용 삭제', [['tag_id', name + '_db_delete_day']]], ['globalDbDeleteBtn', '전체 삭제']]], value=arg[name + '_db_delete_day'], col='6') }}
      {{ macros.setting_checkbox(f'{name}_db_auto_delete', 'DB 자동 삭제', value=arg[name + '_db_auto_delete']) }}
    {{ macros.m_tab_content_end() }}
  </div>
</form>

<script>
$(document).ready(function(){
  // 초기 UI 셋업 가능
});

$("body").on('click', '#globalOneExecuteBtn', function(e){
  e.preventDefault();
  globalSendCommand('execute_trade', null, null, null, function(ret){ console.log(ret); });
});
</script>

{% endblock %}
