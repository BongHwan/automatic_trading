{% extends "base.html" %}
{% block content %}

{{ macros.m_button_group([['globalSettingSaveBtn', '설정 저장'], ['executeTradingBtn', '즉시 실행']]) }}
{{ macros.m_row_start('5') }}
{{ macros.m_row_end() }}

<nav>
  {{ macros.m_tab_head_start() }}
    {{ macros.m_tab_head('basic', '기본', true) }}
    {{ macros.m_tab_head('db', 'DB', false) }}
  {{ macros.m_tab_head_end() }}
</nav>

<form id='setting_form'>
  <div class="tab-content" id="nav-tabContent">
    {{ macros.m_tab_content_start('basic', true) }}
      {{ macros.setting_input_text('api_key', 'API Key', desc='거래소 API Key', value=arg['api_key'], col=6) }}
      {{ macros.setting_input_text('api_secret', 'API Secret', desc='거래소 API Secret', value=arg['api_secret'], col=6) }}
      {{ macros.setting_input_int('trade_amount', '거래 기본 수량', value=arg['trade_amount'], col=3) }}
      {{ macros.setting_radio_with_value('mode', '모드', [['simulation','시뮬레이션'],['live','실거래']], value=arg['mode'], desc=['시뮬레이션 모드 또는 실거래 모드 선택']) }}
      {{ macros.m_hr() }}
      {{ macros.setting_buttons([['test_connect_btn', '연결 테스트'], ['reset_btn','초기화']]) }}
    {{ macros.m_tab_content_end() }}

    {{ macros.m_tab_content_start('db', false) }}
      {{ macros.setting_input_text_and_buttons('db_keep_days', 'DB 보관 기간(일)', [['applyDbBtn','적용']], value=arg['db_keep_days'], col=3) }}
      {{ macros.setting_checkbox('db_auto_delete', 'DB 자동 삭제', value=arg['db_auto_delete'], desc=['On: 지정 기간 지난 데이터 자동 삭제']) }}
    {{ macros.m_tab_content_end() }}
  </div>
</form>

<script type="text/javascript">

$(document).ready(function(){
  // 기본 탭 활성화
  showTab('basic');
});

// 탭 클릭
$('input[type=radio][name=driver_mode]').change(function() {
  set_driver_mode(this.value);
});

// 버튼 이벤트
$("body").on('click', '#globalSettingSaveBtn', function(e){
  e.preventDefault();
  globalSendCommand('save_settings', $('#setting_form').serialize());
});

$("body").on('click', '#executeTradingBtn', function(e){
  e.preventDefault();
  globalSendCommand('execute_trading');
});

</script>

{% endblock %}
